<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Umut Bird</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      background: linear-gradient(to bottom, #4ec0ca, #ffffff);
      overflow: hidden; /* Oyun tam ekran gözüksün */
      font-family: sans-serif;
    }
    #gameContainer {
      position: relative;
      width: 100vw;
      height: 100vh;
      background: #70c5ce;
    }
    /* Başlangıç ekranı */
    #startScreen {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-color: rgba(0,0,0,0.5);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: white;
      z-index: 999;
    }
    #startScreen button {
      padding: 20px 40px;
      font-size: 20px;
      cursor: pointer;
      background-color: #ffcc00;
      border: none;
      border-radius: 10px;
      margin-top: 20px;
    }
    #gameCanvas {
      display: block;
      background: #70c5ce;
    }
    /* Oyun bitti ekranı */
    #gameOverScreen {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-color: rgba(0,0,0,0.5);
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: white;
      z-index: 1000;
      text-align: center;
    }
    #gameOverScreen button {
      margin-top: 20px;
      padding: 15px 30px;
      font-size: 18px;
      cursor: pointer;
      background-color: #ffcc00;
      border: none;
      border-radius: 10px;
    }

    /* Ekranın en sağında yer alacak seymos.png için stil */
    #seymosImg {
      position: absolute;
      top: 50px;
      /* Sol/sağ konumu JavaScript ile güncellenecek */
      width: 150px; 
      display: none; /* Oyun başlayınca görünecek şekilde ayarlayacağız */
      z-index: 10;   /* Canvas'ın üstünde görünebilmesi için */
    }
  </style>
</head>
<body>

<div id="gameContainer">
  <!-- Başlangıç Ekranı -->
  <div id="startScreen">
    <h1>Umut Bird</h1>
    <button id="startBtn">Başla</button>
  </div>

  <!-- Canvas -->
  <canvas id="gameCanvas" width="480" height="640"></canvas>

  <!-- Oyun Bitti Ekranı -->
  <div id="gameOverScreen">
    <h1 id="gameOverText">af yok oç umut</h1>
    <button id="retryBtn">Tekrar Dene</button>
  </div>

  <!-- Ekranın sağındaki seymos.png -->
  <img id="seymosImg" src="seymos.png" alt="Seymos Görseli">
</div>

<!-- SES DOSYALARI -->
<audio id="jumpSound" src="esumut.mp3"></audio>
<audio id="passSound1" src="lütfen.mp3"></audio>
<audio id="passSound2" src="nolursun.mp3"></audio>
<audio id="passSound3" src="seymos.mp3"></audio>
<audio id="passSound4" src="yalvarırım.mp3"></audio>
<!-- Kullanıcı yandığında çalınacak ses -->
<audio id="semiSound" src="semi.mp3"></audio>

<script>
  // Canvas ayarları
  const canvas = document.getElementById('gameCanvas');
  const ctx = canvas.getContext('2d');

  function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  }
  window.addEventListener('resize', resizeCanvas);
  resizeCanvas();

  // Kuş görseli
  const birdImg = new Image();
  birdImg.src = 'umut.png'; // Arka planı şeffaf bir PNG kullanın

  // Seymos görseli (HTML tarafında id="seymosImg" ekledik)
  const seymosImgEl = document.getElementById('seymosImg');

  // Ses elementleri
  const jumpSound = document.getElementById('jumpSound');
  const passSounds = [
    document.getElementById('passSound1'),
    document.getElementById('passSound2'),
    document.getElementById('passSound3'),
    document.getElementById('passSound4')
  ];
  // Kullanıcı yandığında çalacak ses
  const semiSound = document.getElementById('semiSound');

  // Ekran elementleri
  const startScreen = document.getElementById('startScreen');
  const startBtn = document.getElementById('startBtn');
  const gameOverScreen = document.getElementById('gameOverScreen');
  const retryBtn = document.getElementById('retryBtn');

  // Kuşun parametreleri
  let birdX = 50;
  let birdY = 50;
  let birdSize = 40;
  let velocity = 0;
  let gravity = 0.09;   // Düşme hızını biraz daha yumuşattık
  let jumpPower = -4;   // Yukarı zıplama miktarı

  // Engellerin parametreleri
  let obstacles = [];
  let obstacleWidth = 60;
  let gapSize = 220;   // Engeller arasındaki boşluğu büyüttük
  let obstacleSpeed = 2; 
  let frameCount = 0;
  let obstaclesPassed = 0; // Kaç engel geçildi

  // Seymos'un konumu ve boyutu
  let seymosX = 0;     // Başlarken sağa yerleştireceğiz (startGame() içinde ayarlanacak)
  let seymosY = 50;    // Yukarıdan 50px
  let seymosWidth = 150;   // CSS ile aynı değerde tutuyoruz
  let seymosHeight = 150;  // Oranlı resim varsayılıyor

  // Oyun durumu
  let isGameOver = false;
  let isGameStarted = false;

  function gameLoop() {
    if (!isGameOver && isGameStarted) {
      update();
      draw();
    }
    requestAnimationFrame(gameLoop);
  }

  function update() {
    frameCount++;

    // Kuşa yerçekimi uygula
    velocity += gravity;
    birdY += velocity;

    // Seymos'un x konumunu engellerle aynı hızda sola kaydırıyoruz
    seymosX -= obstacleSpeed;
    // HTML img elementinin "left" stilini güncelleyelim:
    seymosImgEl.style.left = seymosX + 'px';

    // Toplam 7 engel oluşturmak istiyoruz
    // - İlk 6 engel normal
    // - 7. engel ise boşluksuz (geçilemez)
    // Engelleri belirli aralıklarla yaratmaya devam, ama 7'ye ulaşınca dur.
    if (obstacles.length < 7 && frameCount % 250 === 0) {
      // Engellerin sayısı 6'ya ulaştıysa, sıradaki engeli (7.) boşluksuz yap
      if (obstacles.length === 6) {
        createFinalObstacle(); // 7. engel (boşluksuz)
      } else {
        createObstacle();      // Normal engel
      }
    }

    // Engelleri hareket ettir
    for (let i = 0; i < obstacles.length; i++) {
      obstacles[i].x -= obstacleSpeed;

      // Kuş engeli tamamen geçince rastgele ses çal
      if (!obstacles[i].isPassed && obstacles[i].x + obstacleWidth < birdX) {
        obstacles[i].isPassed = true; 
        playRandomPassSound();
        obstaclesPassed++;

        // Her 5 engelde hız arttır
        if (obstaclesPassed % 5 === 0) {
          obstacleSpeed += 0.5; 
        }

        // Her 3 engelde frameCount'u 20 azalt
        if (obstaclesPassed % 3 === 0) {
          frameCount -= 20;
          if (frameCount < 0) frameCount = 0;
        }
      }

      // Ekrandan çıkan engeli listeden kaldır
      if (obstacles[i].x + obstacleWidth < 0) {
        obstacles.splice(i, 1);
        i--;
      }
    }

    // Kuşun ekran dışına çıkma durumu
    if (birdY + birdSize > canvas.height || birdY < 0) {
      gameOver();
    }

    // Engellere çarpma kontrolü
    checkCollision();
  }

  function draw() {
    // Canvas'ı temizleyelim
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Kuşu çiz
    ctx.drawImage(birdImg, birdX, birdY, birdSize, birdSize);

    // Engelleri çiz
    obstacles.forEach(obs => {
      ctx.fillStyle = '#228B22';
      // Üst engel
      ctx.fillRect(obs.x, 0, obstacleWidth, obs.topHeight);
      // Alt engel
      ctx.fillRect(obs.x, obs.bottomY, obstacleWidth, obs.bottomHeight);
    });
  }

  // Normal engel oluşturma
  function createObstacle() {
    const topHeight = Math.floor(Math.random() * (canvas.height - gapSize - 100)) + 50;
    const bottomHeight = canvas.height - topHeight - gapSize;
    obstacles.push({
      x: canvas.width,
      topHeight: topHeight,
      bottomHeight: bottomHeight,
      bottomY: topHeight + gapSize,
      isPassed: false
    });
  }

  // 7. engel (boşluksuz) -> geçilemez
  function createFinalObstacle() {
    obstacles.push({
      x: canvas.width,
      topHeight: canvas.height, // Tüm ekran kadar
      bottomHeight: 0,
      bottomY: canvas.height,   // Alt engel yok
      isPassed: false
    });
  }

  function checkCollision() {
    for (let i = 0; i < obstacles.length; i++) {
      let obs = obstacles[i];
      if (
        birdX + birdSize > obs.x && 
        birdX < obs.x + obstacleWidth
      ) {
        // Üst veya alt engelle temas
        if (birdY < obs.topHeight || (birdY + birdSize) > obs.bottomY) {
          gameOver();
          break;
        }
      }
    }
  }

  function playRandomPassSound() {
    const index = Math.floor(Math.random() * passSounds.length);
    passSounds[index].currentTime = 0;
    passSounds[index].play();
  }

  function gameOver() {
    isGameOver = true;
    gameOverScreen.style.display = 'flex';
    // Kullanıcı yandığında semi.mp3 çalsın
    semiSound.currentTime = 0;
    semiSound.play();
  }

  function startGame() {
    isGameOver = false;
    isGameStarted = true;
    gameOverScreen.style.display = 'none';
    startScreen.style.display = 'none';

    // semi.mp3 çalıyorsa durdur
    semiSound.pause();
    semiSound.currentTime = 0;

    // Değerleri sıfırla
    birdX = 50;
    birdY = canvas.height / 2 - birdSize / 2;
    velocity = 0;
    obstacles = [];
    frameCount = 0;
    obstaclesPassed = 0;
    obstacleSpeed = 2;

    // Seymos başlangıçta ekranın sağında belirecek
    // Genişlik: seymosWidth = 150
    // Ekranda sağdan 50px içeride gibi görünmesi için:
    seymosX = canvas.width - seymosWidth - 50;
    seymosY = 50; 
    // HTML img görünür olsun
    seymosImgEl.style.display = 'block';
    seymosImgEl.style.left = seymosX + 'px';
    seymosImgEl.style.top = seymosY + 'px';
  }

  // Space tuşu ile zıplama
  document.addEventListener('keydown', function(e) {
    if (e.code === 'Space') {
      jumpSound.currentTime = 0;
      jumpSound.play();
      velocity = jumpPower;
    }
  });

  // Başlat butonu
  startBtn.addEventListener('click', function() {
    startGame();
  });

  // Tekrar dene butonu
  retryBtn.addEventListener('click', function() {
    startGame();
  });

  // Animasyonu başlat
  gameLoop();
</script>
</body>
</html>
